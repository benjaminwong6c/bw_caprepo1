Ben modified from development branch 4/30